<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="466px" preserveAspectRatio="none" style="width:851px;height:466px;" version="1.1" viewBox="0 0 851 466" width="851px" zoomAndPan="magnify"><defs><filter height="300%" id="f6ofa2869d0nh" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="151" x="350.5" y="22.9951">User redirect in proxy</text><rect fill="#FFFFFF" filter="url(#f6ofa2869d0nh)" height="148.4688" style="stroke: #000000; stroke-width: 2.0;" width="668" x="56" y="231.2578"/><rect fill="#FFFFFF" height="73.0703" style="stroke: none; stroke-width: 1.0;" width="668" x="56" y="306.6563"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="32" x2="32" y1="68.5938" y2="425.8594"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="93" x2="93" y1="68.5938" y2="425.8594"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="193" x2="193" y1="68.5938" y2="425.8594"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="470" x2="470" y1="68.5938" y2="425.8594"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="552" x2="552" y1="68.5938" y2="425.8594"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="661" x2="661" y1="68.5938" y2="425.8594"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="784" x2="784" y1="68.5938" y2="425.8594"/><rect fill="#F8F8F8" filter="url(#f6ofa2869d0nh)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="44" x="8" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="15" y="53.292">User</text><rect fill="#F8F8F8" filter="url(#f6ofa2869d0nh)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="44" x="8" y="424.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="15" y="444.8545">User</text><rect fill="#F8F8F8" filter="url(#f6ofa2869d0nh)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="51" x="66" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="73" y="53.292">Client</text><rect fill="#F8F8F8" filter="url(#f6ofa2869d0nh)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="51" x="66" y="424.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="73" y="444.8545">Client</text><rect fill="#F8F8F8" filter="url(#f6ofa2869d0nh)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="121" x="131" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="138" y="53.292">Adgangsplatform</text><rect fill="#F8F8F8" filter="url(#f6ofa2869d0nh)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="121" x="131" y="424.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="138" y="444.8545">Adgangsplatform</text><rect fill="#F8F8F8" filter="url(#f6ofa2869d0nh)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="47" x="445" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="452" y="53.292">CULR</text><rect fill="#F8F8F8" filter="url(#f6ofa2869d0nh)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="47" x="445" y="424.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="452" y="444.8545">CULR</text><rect fill="#F8F8F8" filter="url(#f6ofa2869d0nh)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="88" x="506" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="513" y="53.292">Local_proxy</text><rect fill="#F8F8F8" filter="url(#f6ofa2869d0nh)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="88" x="506" y="424.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="513" y="444.8545">Local_proxy</text><rect fill="#F8F8F8" filter="url(#f6ofa2869d0nh)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="102" x="608" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="615" y="53.292">Foreign_proxy</text><rect fill="#F8F8F8" filter="url(#f6ofa2869d0nh)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="102" x="608" y="424.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="615" y="444.8545">Foreign_proxy</text><rect fill="#F8F8F8" filter="url(#f6ofa2869d0nh)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="116" x="724" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="102" x="731" y="53.292">Remote_service</text><rect fill="#F8F8F8" filter="url(#f6ofa2869d0nh)" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="116" x="724" y="424.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="102" x="731" y="444.8545">Remote_service</text><polygon fill="#383838" points="81.5,95.7266,91.5,99.7266,81.5,103.7266,85.5,99.7266" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="32" x2="87.5" y1="99.7266" y2="99.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="39" y="94.6606">Login</text><polygon fill="#383838" points="181.5,124.8594,191.5,128.8594,181.5,132.8594,185.5,128.8594" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="93.5" x2="187.5" y1="128.8594" y2="128.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="100.5" y="123.7935">Login</text><polygon fill="#383838" points="458.5,153.9922,468.5,157.9922,458.5,161.9922,462.5,157.9922" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="193.5" x2="464.5" y1="157.9922" y2="157.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="200.5" y="152.9263">Get user domain</text><polygon fill="#383838" points="204.5,183.125,194.5,187.125,204.5,191.125,200.5,187.125" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="198.5" x2="469.5" y1="187.125" y2="187.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="253" x="210.5" y="182.0591">Domain GUID, Agencies, Home Municipality</text><polygon fill="#383838" points="104.5,212.2578,94.5,216.2578,104.5,220.2578,100.5,216.2578" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="98.5" x2="192.5" y1="216.2578" y2="216.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="110.5" y="211.1919">Domain</text><path d="M56,231.2578 L119,231.2578 L119,238.2578 L109,248.2578 L56,248.2578 L56,231.2578 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="148.4688" style="stroke: #000000; stroke-width: 2.0;" width="668" x="56" y="231.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="71" y="244.3247">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="313" x="134" y="243.4683">[Local user: Client municipality == User home municipality]</text><polygon fill="#383838" points="540,265.5234,550,269.5234,540,273.5234,544,269.5234" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="93.5" x2="546" y1="269.5234" y2="269.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="100.5" y="264.4575">Auto login</text><polygon fill="#383838" points="104.5,294.6563,94.5,298.6563,104.5,302.6563,100.5,298.6563" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="98.5" x2="551" y1="298.6563" y2="298.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="110.5" y="293.5903">Session</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="56" x2="724" y1="307.6563" y2="307.6563"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="74" x="61" y="317.8667">[Foreign user]</text><polygon fill="#383838" points="649,338.5938,659,342.5938,649,346.5938,653,342.5938" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="93.5" x2="655" y1="342.5938" y2="342.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="100.5" y="337.5278">Auto login</text><polygon fill="#383838" points="104.5,367.7266,94.5,371.7266,104.5,375.7266,100.5,371.7266" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="98.5" x2="660" y1="371.7266" y2="371.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="110.5" y="366.6606">Session</text><polygon fill="#383838" points="772,403.8594,782,407.8594,772,411.8594,776,407.8594" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="93.5" x2="778" y1="407.8594" y2="407.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="100.5" y="402.7935">Access via session</text><!--
@startuml
title User redirect in proxy

skinparam monochrome true


User -> Client: Login
Client -> Adgangsplatform: Login
Adgangsplatform - -> CULR: Get user domain
CULR - -> Adgangsplatform: Domain GUID, Agencies, Home Municipality
Adgangsplatform -> Client: Domain

alt Local user: Client municipality == User home municipality
    Client -> Local_proxy: Auto login 
    Local_proxy -> Client: Session
else Foreign user
    Client -> Foreign_proxy: Auto login
    Foreign_proxy -> Client: Session
end

Client -> Remote_service: Access via session
@enduml

PlantUML version 1.2019.05(Sat Apr 20 16:45:36 GMT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_202-b08
Operating System: Linux
OS Version: 5.0.0-1023-azure
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>