<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1163px" preserveAspectRatio="none" style="width:1013px;height:1163px;" version="1.1" viewBox="0 0 1013 1163" width="1013px" zoomAndPan="magnify"><defs><filter height="300%" id="fls6484fdw1ik" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="333" x="340.75" y="1150.3232">DDB CMS User authentification (Adgangsplatformen)</text><rect fill="#FFFFFF" filter="url(#fls6484fdw1ik)" height="846.3359" style="stroke: #000000; stroke-width: 2.0;" width="988.5" x="13" y="190.6953"/><rect fill="#FFFFFF" height="740.6719" style="stroke: none; stroke-width: 1.0;" width="988.5" x="13" y="296.3594"/><rect fill="#FFFFFF" filter="url(#fls6484fdw1ik)" height="462.5391" style="stroke: #000000; stroke-width: 2.0;" width="822" x="169.5" y="567.4922"/><rect fill="#FFFFFF" height="387.1406" style="stroke: none; stroke-width: 1.0;" width="822" x="169.5" y="642.8906"/><rect fill="#FFFFFF" filter="url(#fls6484fdw1ik)" height="143.2734" style="stroke: #000000; stroke-width: 2.0;" width="262" x="719.5" y="722.9609"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="46" x2="46" y1="86.2969" y2="1054.0313"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="208.5" x2="208.5" y1="86.2969" y2="1054.0313"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="316.5" x2="316.5" y1="86.2969" y2="1054.0313"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="527.5" x2="527.5" y1="86.2969" y2="1054.0313"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="689.5" x2="689.5" y1="86.2969" y2="1054.0313"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="753.5" x2="753.5" y1="86.2969" y2="1054.0313"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="946.5" x2="946.5" y1="86.2969" y2="1054.0313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="23" y="82.9951">Patron</text><ellipse cx="46.5" cy="13" fill="#F8F8F8" filter="url(#fls6484fdw1ik)" rx="8" ry="8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M46.5,21 L46.5,48 M33.5,29 L59.5,29 M46.5,48 L33.5,63 M46.5,48 L59.5,63 " fill="none" filter="url(#fls6484fdw1ik)" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="23" y="1066.0264">Patron</text><ellipse cx="46.5" cy="1079.3281" fill="#F8F8F8" filter="url(#fls6484fdw1ik)" rx="8" ry="8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M46.5,1087.3281 L46.5,1114.3281 M33.5,1095.3281 L59.5,1095.3281 M46.5,1114.3281 L33.5,1129.3281 M46.5,1114.3281 L59.5,1129.3281 " fill="none" filter="url(#fls6484fdw1ik)" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="179.5" y="82.9951">Browser</text><path d="M188,42 L188,66 M188,54 L205,54 " fill="none" filter="url(#fls6484fdw1ik)" style="stroke: #383838; stroke-width: 2.0;"/><ellipse cx="217" cy="54" fill="#F8F8F8" filter="url(#fls6484fdw1ik)" rx="12" ry="12" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="179.5" y="1066.0264">Browser</text><path d="M188,1073.3281 L188,1097.3281 M188,1085.3281 L205,1085.3281 " fill="none" filter="url(#fls6484fdw1ik)" style="stroke: #383838; stroke-width: 2.0;"/><ellipse cx="217" cy="1085.3281" fill="#F8F8F8" filter="url(#fls6484fdw1ik)" rx="12" ry="12" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="283.5" y="82.9951">DDB CMS</text><ellipse cx="316.5" cy="54" fill="#F8F8F8" filter="url(#fls6484fdw1ik)" rx="12" ry="12" style="stroke: #383838; stroke-width: 2.0;"/><line style="stroke: #383838; stroke-width: 2.0;" x1="304.5" x2="328.5" y1="68" y2="68"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="283.5" y="1066.0264">DDB CMS</text><ellipse cx="316.5" cy="1085.3281" fill="#F8F8F8" filter="url(#fls6484fdw1ik)" rx="12" ry="12" style="stroke: #383838; stroke-width: 2.0;"/><line style="stroke: #383838; stroke-width: 2.0;" x1="304.5" x2="328.5" y1="1099.3281" y2="1099.3281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="487.5" y="82.9951">login.bib.dk</text><ellipse cx="527.5" cy="54" fill="#F8F8F8" filter="url(#fls6484fdw1ik)" rx="12" ry="12" style="stroke: #383838; stroke-width: 2.0;"/><polygon fill="#383838" points="523.5,42,529.5,37,527.5,42,529.5,47,523.5,42" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="487.5" y="1066.0264">login.bib.dk</text><ellipse cx="527.5" cy="1085.3281" fill="#F8F8F8" filter="url(#fls6484fdw1ik)" rx="12" ry="12" style="stroke: #383838; stroke-width: 2.0;"/><polygon fill="#383838" points="523.5,1073.3281,529.5,1068.3281,527.5,1073.3281,529.5,1078.3281,523.5,1073.3281" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="659.5" y="82.9951">BORCHK</text><path d="M669,42 L669,66 M669,54 L686,54 " fill="none" filter="url(#fls6484fdw1ik)" style="stroke: #383838; stroke-width: 2.0;"/><ellipse cx="698" cy="54" fill="#F8F8F8" filter="url(#fls6484fdw1ik)" rx="12" ry="12" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="659.5" y="1066.0264">BORCHK</text><path d="M669,1073.3281 L669,1097.3281 M669,1085.3281 L686,1085.3281 " fill="none" filter="url(#fls6484fdw1ik)" style="stroke: #383838; stroke-width: 2.0;"/><ellipse cx="698" cy="1085.3281" fill="#F8F8F8" filter="url(#fls6484fdw1ik)" rx="12" ry="12" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="734.5" y="82.9951">CULR</text><path d="M733.5,42 L733.5,66 M733.5,54 L750.5,54 " fill="none" filter="url(#fls6484fdw1ik)" style="stroke: #383838; stroke-width: 2.0;"/><ellipse cx="762.5" cy="54" fill="#F8F8F8" filter="url(#fls6484fdw1ik)" rx="12" ry="12" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="734.5" y="1066.0264">CULR</text><path d="M733.5,1073.3281 L733.5,1097.3281 M733.5,1085.3281 L750.5,1085.3281 " fill="none" filter="url(#fls6484fdw1ik)" style="stroke: #383838; stroke-width: 2.0;"/><ellipse cx="762.5" cy="1085.3281" fill="#F8F8F8" filter="url(#fls6484fdw1ik)" rx="12" ry="12" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="26" x="931" y="82.9951">LMS</text><path d="M926.5,42 L926.5,66 M926.5,54 L943.5,54 " fill="none" filter="url(#fls6484fdw1ik)" style="stroke: #383838; stroke-width: 2.0;"/><ellipse cx="955.5" cy="54" fill="#F8F8F8" filter="url(#fls6484fdw1ik)" rx="12" ry="12" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="26" x="931" y="1066.0264">LMS</text><path d="M926.5,1073.3281 L926.5,1097.3281 M926.5,1085.3281 L943.5,1085.3281 " fill="none" filter="url(#fls6484fdw1ik)" style="stroke: #383838; stroke-width: 2.0;"/><ellipse cx="955.5" cy="1085.3281" fill="#F8F8F8" filter="url(#fls6484fdw1ik)" rx="12" ry="12" style="stroke: #383838; stroke-width: 2.0;"/><polygon fill="#383838" points="196.5,113.4297,206.5,117.4297,196.5,121.4297,200.5,117.4297" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="46.5" x2="202.5" y1="117.4297" y2="117.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="53.5" y="112.3638">Log in</text><polygon fill="#383838" points="304.5,142.5625,314.5,146.5625,304.5,150.5625,308.5,146.5625" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="208.5" x2="310.5" y1="146.5625" y2="146.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="215.5" y="141.4966">Log in</text><polygon fill="#383838" points="515.5,171.6953,525.5,175.6953,515.5,179.6953,519.5,175.6953" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="316.5" x2="521.5" y1="175.6953" y2="175.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="323.5" y="170.6294">Request authentification of user</text><path d="M13,190.6953 L76,190.6953 L76,197.6953 L66,207.6953 L13,207.6953 L13,190.6953 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="846.3359" style="stroke: #000000; stroke-width: 2.0;" width="988.5" x="13" y="190.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="28" y="203.7622">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="211" x="91" y="202.9058">[User is already logged in (login cookie)]</text><polygon fill="#383838" points="327.5,255.2266,317.5,259.2266,327.5,263.2266,323.5,259.2266" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="321.5" x2="526.5" y1="259.2266" y2="259.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="333.5" y="223.895">Return GUID, session token,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="333.5" y="239.0278">muncipality ID and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="333.5" y="254.1606">active agencies for userID</text><path d="M532,215.3945 L532,255.3945 L859,255.3945 L859,225.3945 L849,215.3945 L532,215.3945 " fill="#ECECEC" filter="url(#fls6484fdw1ik)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M849,215.3945 L849,225.3945 L859,225.3945 L849,215.3945 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="538" y="232.4614">If profile was created on login,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="306" x="538" y="247.5942">login agency is the only returned for userID@Agency</text><polygon fill="#383838" points="219.5,284.3594,209.5,288.3594,219.5,292.3594,215.5,288.3594" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="213.5" x2="315.5" y1="288.3594" y2="288.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="225.5" y="283.2935">User logged in</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="1001.5" y1="297.3594" y2="297.3594"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="81" x="18" y="307.5698">[Login process]</text><polygon fill="#383838" points="219.5,328.2969,209.5,332.2969,219.5,336.2969,215.5,332.2969" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="213.5" x2="526.5" y1="332.2969" y2="332.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="225.5" y="327.231">Get Agency, userID and PIN</text><polygon fill="#383838" points="57.5,372.5625,47.5,376.5625,57.5,380.5625,53.5,376.5625" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="51.5" x2="207.5" y1="376.5625" y2="376.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="63.5" y="356.3638">Enter Agency,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="63.5" y="371.4966">userID and PIN</text><polygon fill="#383838" points="196.5,401.6953,206.5,405.6953,196.5,409.6953,200.5,405.6953" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="46.5" x2="202.5" y1="405.6953" y2="405.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="53.5" y="400.6294">Agency, userID and PIN</text><polygon fill="#383838" points="515.5,445.9609,525.5,449.9609,515.5,453.9609,519.5,449.9609" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="208.5" x2="521.5" y1="449.9609" y2="449.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="218.5" y="429.7622"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="215.5" y="444.895">Agency, userID and PIN</text><polygon fill="#383838" points="677.5,475.0938,687.5,479.0938,677.5,483.0938,681.5,479.0938" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="527.5" x2="683.5" y1="479.0938" y2="479.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="534.5" y="474.0278">Agency, userID and PIN</text><polygon fill="#383838" points="935,519.3594,945,523.3594,935,527.3594,939,523.3594" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="689.5" x2="941" y1="523.3594" y2="523.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="696.5" y="503.1606">Authenticate:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="696.5" y="518.2935">Agency, userID and PIN</text><polygon fill="#383838" points="700.5,548.4922,690.5,552.4922,700.5,556.4922,696.5,552.4922" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="694.5" x2="946" y1="552.4922" y2="552.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="706.5" y="547.4263">TRUE/FALSE</text><path d="M169.5,567.4922 L232.5,567.4922 L232.5,574.4922 L222.5,584.4922 L169.5,584.4922 L169.5,567.4922 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="462.5391" style="stroke: #000000; stroke-width: 2.0;" width="822" x="169.5" y="567.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="184.5" y="580.5591">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="173" x="247.5" y="579.7026">[BORCHK: FALSE (User rejected)]</text><polygon fill="#383838" points="538.5,601.7578,528.5,605.7578,538.5,609.7578,534.5,605.7578" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="532.5" x2="688.5" y1="605.7578" y2="605.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="544.5" y="600.6919">User rejected</text><polygon fill="#383838" points="219.5,630.8906,209.5,634.8906,219.5,638.8906,215.5,634.8906" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="213.5" x2="526.5" y1="634.8906" y2="634.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="225.5" y="629.8247">Login failed</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="169.5" x2="991.5" y1="643.8906" y2="643.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="201" x="174.5" y="654.1011">[BORCHK: TRUE (User authenticated)]</text><polygon fill="#383838" points="538.5,674.8281,528.5,678.8281,538.5,682.8281,534.5,678.8281" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="532.5" x2="688.5" y1="678.8281" y2="678.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="544.5" y="673.7622">User authenticated</text><polygon fill="#383838" points="742,703.9609,752,707.9609,742,711.9609,746,707.9609" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="527.5" x2="748" y1="707.9609" y2="707.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="534.5" y="702.895">Get profile for userID@Agency</text><path d="M719.5,722.9609 L782.5,722.9609 L782.5,729.9609 L772.5,739.9609 L719.5,739.9609 L719.5,722.9609 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="143.2734" style="stroke: #000000; stroke-width: 2.0;" width="262" x="719.5" y="722.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="734.5" y="736.0278">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="797.5" y="735.1714">[Create user profile</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="114" x="797.5" y="747.9761">if not found in CULR]</text><polygon fill="#383838" points="935,767.8359,945,771.8359,935,775.8359,939,771.8359" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="754" x2="941" y1="771.8359" y2="771.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="761" y="766.77">Get user profile</text><polygon fill="#383838" points="765,796.9688,755,800.9688,765,804.9688,761,800.9688" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="759" x2="946" y1="800.9688" y2="800.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="771" y="795.9028">UserID, MunicipalityNo</text><line style="stroke: #383838; stroke-width: 1.0;" x1="754" x2="796" y1="845.2344" y2="845.2344"/><line style="stroke: #383838; stroke-width: 1.0;" x1="796" x2="796" y1="845.2344" y2="858.2344"/><line style="stroke: #383838; stroke-width: 1.0;" x1="755" x2="796" y1="858.2344" y2="858.2344"/><polygon fill="#383838" points="765,854.2344,755,858.2344,765,862.2344,761,858.2344" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="761" y="825.0356">Create profile (GUID)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="761" y="840.1685">for agency with MunicipalityNo</text><polygon fill="#383838" points="538.5,905.5,528.5,909.5,538.5,913.5,534.5,909.5" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="532.5" x2="753" y1="909.5" y2="909.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="544.5" y="889.3013">Return GUID and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="544.5" y="904.4341">active agencies for userID</text><polygon fill="#383838" points="219.5,934.6328,209.5,938.6328,219.5,942.6328,215.5,938.6328" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="213.5" x2="526.5" y1="938.6328" y2="938.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="225.5" y="933.5669">Set login cookie (User Token)</text><polygon fill="#383838" points="327.5,978.8984,317.5,982.8984,327.5,986.8984,323.5,982.8984" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="321.5" x2="526.5" y1="982.8984" y2="982.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="333.5" y="962.6997">Return GUID, session token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="333.5" y="977.8325">and active agencies for userI</text><path d="M532,954.1992 L532,979.1992 L831,979.1992 L831,964.1992 L821,954.1992 L532,954.1992 " fill="#ECECEC" filter="url(#fls6484fdw1ik)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M821,954.1992 L821,964.1992 L831,964.1992 L821,954.1992 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="538" y="971.2661">+ additional info configured (CPR, Local user ID)</text><polygon fill="#383838" points="219.5,1013.0313,209.5,1017.0313,219.5,1021.0313,215.5,1017.0313" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="213.5" x2="315.5" y1="1017.0313" y2="1017.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="225.5" y="1011.9653">User logged in</text><path d="M321,995.8984 L321,1020.8984 L561,1020.8984 L561,1005.8984 L551,995.8984 L321,995.8984 " fill="#ECECEC" filter="url(#fls6484fdw1ik)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M551,995.8984 L551,1005.8984 L561,1005.8984 L551,995.8984 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="327" y="1012.9653">Ready to get more user info from LMS</text><!--MD5=[85a11b45a1afac27a517b2f5639e9ce7]
@startuml
caption DDB CMS User authentification (Adgangsplatformen)

skinparam monochrome true

actor Patron
boundary Browser
entity DDBCMS as "DDB CMS"
control login.bib.dk 
boundary BORCHK 
            
boundary CULR
boundary LMS 

Patron->Browser: Log in
Browser->DDBCMS: Log in
DDBCMS->login.bib.dk: Request authentification of user

alt User is already logged in (login cookie)
    login.bib.dk->DDBCMS: Return GUID, session token, \nmuncipality ID and \nactive agencies for userID
            note right: If profile was created on login, \nlogin agency is the only returned for userID@Agency
    DDBCMS->Browser: User logged in
else Login process
    login.bib.dk->Browser: Get Agency, userID and PIN
    Browser->Patron: Enter Agency,\nuserID and PIN
    Patron->Browser: Agency, userID and PIN
    Browser->login.bib.dk: \nAgency, userID and PIN

    login.bib.dk->BORCHK: Agency, userID and PIN

    BORCHK->LMS: Authenticate: \nAgency, userID and PIN
    LMS- ->BORCHK: TRUE/FALSE

    alt BORCHK: FALSE (User rejected)
        BORCHK->login.bib.dk: User rejected
        login.bib.dk->Browser: Login failed
    else BORCHK: TRUE (User authenticated)
        BORCHK->login.bib.dk: User authenticated
        login.bib.dk->CULR: Get profile for userID@Agency
                               
            alt Create user profile \nif not found in CULR
                CULR -> LMS: Get user profile
                CULR <- - LMS: UserID, MunicipalityNo
                CULR->CULR: Create profile (GUID) \nfor agency with MunicipalityNo
            end
        login.bib.dk<- -CULR: Return GUID and \nactive agencies for userID
        login.bib.dk->Browser: Set login cookie (User Token)
        login.bib.dk->DDBCMS: Return GUID, session token\nand active agencies for userI
            note right:+ additional info configured (CPR, Local user ID)
        DDBCMS- ->Browser: User logged in
            note right: Ready to get more user info from LMS
    end
end
@enduml

PlantUML version 1.2019.13(Tue Dec 10 17:18:29 GMT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_202-b08
Operating System: Linux
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>